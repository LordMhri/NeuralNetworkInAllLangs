@test "xor" {
    run ./app/CSharp --logical
    printf 'Lines:\n'
    printf 'lines %s\n' "${lines[@]}" >&2
    printf 'output %s\n' "${output[@]}" >&2
    [ "${lines[0]}" = "Result after 4000 iterations" ]
    [ "${lines[1]}" = "        XOR   XNOR    OR   AND   NOR   NAND" ]
    [ "${lines[2]}" = "0,0 = 0.038  0.962 0.038 0.001 0.963  0.999" ]
    [ "${lines[3]}" = "0,1 = 0.961  0.039 0.970 0.026 0.029  0.974" ]
    [ "${lines[4]}" = "1,0 = 0.961  0.039 0.970 0.026 0.030  0.974" ]
    [ "${lines[5]}" = "1,1 = 0.049  0.952 0.994 0.956 0.006  0.044" ]
    [[ "${lines[7]}" =~ WeightsHidden ]]
    [[ "${lines[8]}" =~ -5.94253266329493 ]]
    [[ "${lines[9]}" =~ -7.053489763483629 ]]
    [[ "${lines[10]}" =~ -5.93849179349689 ]]
    [[ "${lines[11]}" =~ -7.080670057743411 ]]
    [[ "${lines[13]}" =~ BiasesHidden ]]
    [[ "${lines[14]}" =~ 8.66080005088484 ]]
    [[ "${lines[15]}" =~ 3.18102806812189 ]]
    [[ "${lines[17]}" =~ WeightsOutput ]]
    [[ "${lines[18]}" =~ 7.02847492235002 ]]
    [[ "${lines[19]}" =~ -7.0385257683402696 ]]
    [[ "${lines[20]}" =~ -1.730833624456504 ]]
    [[ "${lines[21]}" =~ -7.40327103830852 ]]
    [[ "${lines[22]}" =~ 1.55892562488877 ]]
    [[ "${lines[23]}" =~ 7.390186687736159 ]]
    [[ "${lines[24]}" =~ -7.31042627730994 ]]
    [[ "${lines[25]}" =~ 7.32111860535136 ]]
    [[ "${lines[26]}" =~ -7.03879901708655 ]]
    [[ "${lines[27]}" =~ -2.80022046282448 ]]
    [[ "${lines[28]}" =~ 7.071517018377268 ]]
    [[ "${lines[29]}" =~ 3.21919221700788 ]]
    [[ "${lines[31]}" =~ BiasesOutput ]]
    [[ "${lines[32]}" =~ -3.245795100480243 ]]
    [[ "${lines[33]}" =~ 3.250424023612059 ]]
    [[ "${lines[34]}" =~ 5.2467380115760 ]]
    [[ "${lines[35]}" =~ 3.36378125079356 ]]
    [[ "${lines[36]}" =~ -5.097046597754945 ]]
    [[ "${lines[37]}" =~ -3.361940360109141 ]]
}

@test "digits" {
    run ./app/CSharp --semeion ../semeion.data 14 10 0.5
    printf 'Lines:\n'
    printf 'lines %s\n' "${lines[@]}" >&2
    printf 'output %s\n' "${output[@]}" >&2
    [ "${lines[0]}" = "accuracy: 85.876 % (1368/1593), avg confidence: 68.060 %" ]
    [ "${lines[1]}" = "accuracy: 91.965 % (1465/1593), avg confidence: 78.090 %" ]
    [ "${lines[2]}" = "accuracy: 95.041 % (1514/1593), avg confidence: 84.804 %" ]
    [ "${lines[3]}" = "accuracy: 96.673 % (1540/1593), avg confidence: 86.184 %" ]
    [ "${lines[4]}" = "accuracy: 97.552 % (1554/1593), avg confidence: 88.259 %" ]
    [ "${lines[5]}" = "accuracy: 98.242 % (1565/1593), avg confidence: 90.609 %" ]
    [ "${lines[6]}" = "accuracy: 98.745 % (1573/1593), avg confidence: 92.303 %" ]
    [ "${lines[7]}" = "accuracy: 98.870 % (1575/1593), avg confidence: 93.385 %" ]
    [ "${lines[8]}" = "accuracy: 98.870 % (1575/1593), avg confidence: 93.261 %" ]
    [ "${lines[9]}" = "accuracy: 99.121 % (1579/1593), avg confidence: 94.304 %" ]
    [ "${lines[10]}" = "        ******* " ]
    [ "${lines[11]}" = "     ****** *** " ]
    [ "${lines[12]}" = "  ******     ** " ]
    [ "${lines[13]}" = " *****      ****" ]
    [ "${lines[14]}" = "****      ***** " ]
    [ "${lines[15]}" = "***       ***   " ]
    [ "${lines[16]}" = "**      *****   " ]
    [ "${lines[17]}" = "**** **** ***   " ]
    [ "${lines[18]}" = " ******* ***    " ]
    [ "${lines[19]}" = "         ***    " ]
    [ "${lines[20]}" = "        ***     " ]
    [ "${lines[21]}" = "       ***      " ]
    [ "${lines[22]}" = "      ****      " ]
    [ "${lines[23]}" = "     ***        " ]
    [ "${lines[24]}" = "  ******        " ]
    [ "${lines[25]}" = "  ***           " ]
    [ "${lines[26]}" = "Prediction (output from network for the above input):" ]
    [ "${lines[27]}" = "0:  0.252 %" ]
    [ "${lines[28]}" = "1:  0.253 %" ]
    [ "${lines[29]}" = "2:  0.010 %" ]
    [ "${lines[30]}" = "3:  0.028 %" ]
    [ "${lines[31]}" = "4:  0.005 %" ]
    [ "${lines[32]}" = "5:  4.867 %" ]
    [ "${lines[33]}" = "6:  0.000 %" ]
    [ "${lines[34]}" = "7:  2.864 %" ]
    [ "${lines[35]}" = "8:  7.070 %" ]
    [ "${lines[36]}" = "9: 94.103 % <-- best prediction" ]
}
