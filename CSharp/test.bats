setup() {
    dotnet publish --configuration Release --output app CSharp.csproj
}

@test "xor" {
    run ./app/CSharp
    printf 'Lines:\n'
    printf 'lines %s\n' "${lines[@]}" >&2
    printf 'output %s\n' "${output[@]}" >&2
    [ "${lines[0]}" = "Result after 4000 iterations" ]
    [ "${lines[1]}" = "        XOR   XNOR    OR   AND   NOR   NAND" ]
    [ "${lines[2]}" = "0,0 = 0.038  0.962 0.038 0.001 0.963  0.999" ]
    [ "${lines[3]}" = "0,1 = 0.961  0.039 0.970 0.026 0.029  0.974" ]
    [ "${lines[4]}" = "1,0 = 0.961  0.039 0.970 0.026 0.030  0.974" ]
    [ "${lines[5]}" = "1,1 = 0.049  0.952 0.994 0.956 0.006  0.044" ]
    [[ "${lines[7]}" =~ WeightsHidden ]]
    [[ "${lines[9]}" =~ -5.94253266329493 ]]
    [[ "${lines[10]}" =~ -7.053489763483629 ]]
    [[ "${lines[13]}" =~ -5.93849179349689 ]]
    [[ "${lines[14]}" =~ -7.080670057743411 ]]
    [[ "${lines[17]}" =~ BiasesHidden ]]
    [[ "${lines[18]}" =~ 8.66080005088484 ]]
    [[ "${lines[19]}" =~ 3.18102806812189 ]]
    [[ "${lines[21]}" =~ WeightsOutput ]]
    [[ "${lines[23]}" =~ 7.02847492235002 ]]
    [[ "${lines[24]}" =~ -7.0385257683402696 ]]
    [[ "${lines[25]}" =~ -1.730833624456504 ]]
    [[ "${lines[26]}" =~ -7.40327103830852 ]]
    [[ "${lines[27]}" =~ 1.55892562488877 ]]
    [[ "${lines[28]}" =~ 7.390186687736159 ]]
    [[ "${lines[31]}" =~ -7.31042627730994 ]]
    [[ "${lines[32]}" =~ 7.32111860535136 ]]
    [[ "${lines[33]}" =~ -7.03879901708655 ]]
    [[ "${lines[34]}" =~ -2.80022046282448 ]]
    [[ "${lines[35]}" =~ 7.071517018377268 ]]
    [[ "${lines[36]}" =~ 3.21919221700788 ]]
    [[ "${lines[39]}" =~ BiasesOutput ]]
    [[ "${lines[40]}" =~ -3.245795100480243 ]]
    [[ "${lines[41]}" =~ 3.250424023612059 ]]
    [[ "${lines[42]}" =~ 5.2467380115760 ]]
    [[ "${lines[43]}" =~ 3.36378125079356 ]]
    [[ "${lines[44]}" =~ -5.097046597754945 ]]
    [[ "${lines[45]}" =~ -3.361940360109141 ]]
}
