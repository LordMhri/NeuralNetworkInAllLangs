setup() {
    dotnet publish --configuration Release --output app FSharp.fsproj
}

@test "xor" {
    run ./app/FSharp
    printf 'Lines:\n'
    printf 'lines %s\n' "${lines[@]}" >&2
    printf 'output %s\n' "${output[@]}" >&2
    [ "${lines[0]}" = "Result after 4000 iterations" ]
    [ "${lines[1]}" = "        XOR   XNOR    OR   AND   NOR   NAND" ]
    [ "${lines[2]}" = "0,0 = 0.038  0.962 0.038 0.001 0.963  0.999" ]
    [ "${lines[3]}" = "0,1 = 0.961  0.039 0.970 0.026 0.029  0.974" ]
    [ "${lines[4]}" = "1,0 = 0.961  0.039 0.970 0.026 0.030  0.974" ]
    [ "${lines[5]}" = "1,1 = 0.049  0.952 0.994 0.956 0.006  0.044" ]
    [ "${lines[6]}" = "network: { BiasesHidden = [|8.660800051; 3.181028068|]" ]
    [ "${lines[7]}" = "  BiasesOutput =" ]
    [ "${lines[8]}" = "   [|-3.2457951; 3.250424024; 5.246738012; 3.363781251; -5.097046598;" ]
    [ "${lines[9]}" = "     -3.36194036|]" ]
    [ "${lines[10]}" = "  WeightsHidden = [|-5.942532663; -7.053489763; -5.938491793; -7.080670058|]" ]
    [ "${lines[12]}" = "   [|7.028474922; -7.038525768; -1.730833624; -7.403271038; 1.558925625;" ]
    [ "${lines[13]}" = "     7.390186688; -7.310426277; 7.321118605; -7.038799017; -2.800220463;" ]
    [ "${lines[14]}" = "     7.071517018; 3.219192217|] }" ]
}
